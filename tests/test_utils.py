import os
import pytest

from conduct.utils import macaroon_to_hex


@pytest.mark.parametrize(
    "macaroon, hex_value",
    [
        (
            "admin.macaroon",
            "0201036C6E6402CF01030A1042ECC3F59C8B78E46875B45A6F93D5721201301A160A0761646472657373120472656164120577726974651A130A04696E666F120472656164120577726974651A170A08696E766F69636573120472656164120577726974651A160A076D657373616765120472656164120577726974651A170A086F6666636861696E120472656164120577726974651A160A076F6E636861696E120472656164120577726974651A140A057065657273120472656164120577726974651A120A067369676E6572120867656E6572617465000006202C9265EEC6A2BDEA71C3ABEE95FDA2596591B5871446364C88D27F2217BF8279",  # noqa
        ),
        (
            "invoice.macaroon",
            "0201036C6E640247030A1040ECC3F59C8B78E46875B45A6F93D5721201301A160A0761646472657373120472656164120577726974651A170A08696E766F696365731204726561641205777269746500000620101ADAA5E695B09E362FE9BF4378C8AEA944CBAA561876BC34260CE403C8FB88",  # noqa
        ),
        (
            "readonly.macaroon",
            "0201036C6E64028A01030A1041ECC3F59C8B78E46875B45A6F93D5721201301A0F0A07616464726573731204726561641A0C0A04696E666F1204726561641A100A08696E766F696365731204726561641A0F0A076D6573736167651204726561641A100A086F6666636861696E1204726561641A0F0A076F6E636861696E1204726561641A0D0A05706565727312047265616400000620FC5B88A03114A8AF9C6496BDDD4368780A860EF4B7EC1005CC5D29A5804980D5",  # noqa
        ),
    ],
)
def test_get_macaroon_hex(files_path, macaroon, hex_value):
    assert macaroon_to_hex(os.path.join(files_path, macaroon)) == hex_value
